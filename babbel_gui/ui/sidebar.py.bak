from PyQt6.QtWidgets import QWidget, QVBoxLayout, QCheckBox, QLabel, QFrame
from PyQt6.QtCore import pyqtSignal
from .widgets.extra_toggles import ExtraToggles

class Sidebar(QWidget):
    metadataToggled  = pyqtSignal(bool)
    livePreviewToggled = pyqtSignal(bool)
    extraTogglesChanged = pyqtSignal(dict)

    def __init__(self, *, show_metadata=True, live_preview=True, parent=None):
        super().__init__(parent)
        lay = QVBoxLayout(self)
        lay.setContentsMargins(8,8,8,8)
        lay.setSpacing(8)        self._metadata    = QCheckBox("Show Metadata")
        self._livePreview = QCheckBox("Live Emotion Preview")        self._metadata.setChecked(show_metadata)
        self._livePreview.setChecked(live_preview)        self._metadata.stateChanged.connect(lambda _: self.metadataToggled.emit(self._metadata.isChecked()))
        self._livePreview.stateChanged.connect(lambda _: self.livePreviewToggled.emit(self._livePreview.isChecked()))

        lay.addWidget(QLabel("Controls"))lay.addWidget(self._metadata)
        lay.addWidget(self._livePreview)

        line = QFrame(self)
        line.setFrameShape(QFrame.Shape.HLine)
        line.setFrameShadow(QFrame.Shadow.Sunken)
        lay.addWidget(line)

        lay.addWidget(QLabel("Experience"))
        self._extra = ExtraToggles(self)
        self._extra.togglesChanged.connect(self.extraTogglesChanged.emit)
        lay.addWidget(self._extra)
